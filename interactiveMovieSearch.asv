function interactiveMovieSearch()
<<<<<<< Updated upstream
<<<<<<< Updated upstream
=======
%This function performs the interactive movie search function 
>>>>>>> Stashed changes
=======
%This function performs the interactive movie search function 
>>>>>>> Stashed changes
movies = listofmovies();
if isempty(movies)
    disp('No movies found in the dataset.'); 
    return; 
end 

<<<<<<< Updated upstream
<<<<<<< Updated upstream
=======
%Ensure that the movies dataset is formatted correctly 
>>>>>>> Stashed changes
=======
%Ensure that the movies dataset is formatted correctly 
>>>>>>> Stashed changes
if ~iscell(movies) || size(movies, 2) < 3
    error('Invalid movies data format. Expected a cell array with exactly three columns (movie_name, genre, director).');
end 

moviesTable = cell2table(movies(:,1:3), 'VariableNames', {'movie_name', 'genre', 'director'}); 

while true
<<<<<<< Updated upstream
<<<<<<< Updated upstream
=======
    %This allows for users to get user preferences for their preferred
    %genre and director
>>>>>>> Stashed changes
=======
    %This allows for users to get user preferences for their preferred
    %genre and director
>>>>>>> Stashed changes
    disp('Enter preferred genre (or press Enter to skip):');
    userGenre = strtrim(string(input('', 's')));

    disp('Enter preferred director (or press Enter to skip):'); 
    userDirector = strtrim(string(input('', 's'))); 

<<<<<<< Updated upstream
<<<<<<< Updated upstream
fuzzyGenre = fuzzyMatch(userGenre, string(moviesTable.genre)); %Find a close approximate match to the genre input
fuzzyDirector = fuzzyMatch(userDirector, string(moviesTable.director)); %Find a close approximate to the director input

if userGenre ~= "" && fuzzyGenre ~= "" && userGenre ~= fuzzyGenre %Check if the fuzzy match for the genre is different
    disp(sprintf('Did you mean genre: %s? Showing results...', fuzzyGenre)); %Suggest an alternative genre
end

if userDirector ~= "" && fuzzyDirector ~= "" && userDirector ~= fuzzyDirector %Check if the fuzzy match for the director is different
    disp(sprintf('Did you mean director: %s? Showing results...', fuzzyDirector)); %Suggest an alternative director
end

matches = findMatchingMovies(moviesTable, fuzzyGenre, fuzzyDirector); %Find matching movies

if isempty(matches) %If no exact matches are found
    disp('No exact matches found. Performing fuzzy search for similar director names...'); %Inform user that the program is finding for similar matches
    fuzzyDirector = fuzzyMatch(userDirector, string(moviesTable.director)); %Retry fuzzy matching for the director
end

    if isempty(matches) %If there are still no matches found 
        disp('No exact matches found. Suggesting alternative recommendations...'); %Inform the display of alternative movies
        alternativeMatches = findAlternativeRecommendations(moviesTable, userGenre, userDirector); %Show alternative movie names
=======
=======
>>>>>>> Stashed changes
  
fuzzyGenre = fuzzyMatch(userGenre, string(moviesTable.genre));
fuzzyDirector = fuzzyMatch(userDirector, string(moviesTable.director));

if userGenre ~= "" && fuzzyGenre ~= "" && userGenre ~= fuzzyGenre
    disp(sprintf('Did you mean genre: %s? Showing results...', fuzzyGenre));
end

if userDirector ~= "" && fuzzyDirector ~= "" && userDirector ~= fuzzyDirector
    disp(sprintf('Did you mean director: %s? Showing results...', fuzzyDirector));
end
%Finds movies that matches the user's genre and/or director prefernce 
matches = findMatchingMovies(moviesTable, fuzzyGenre, fuzzyDirector); 

if isempty(matches)
    disp('No exact matches found. Performing fuzzy search for similar director names...');
    
    fuzzyDirector = fuzzyMatch(userDirector, string(moviesTable.director));
    
    if fuzzyDirector ~= ""
        disp(['Did you mean: ', fuzzyDirector, '? Showing results...']);
        matches = findMatchingMovies(moviesTable, userGenre, fuzzyDirector);
    end
end

    if isempty(matches)
        disp('No exact matches found. Suggesting alternative recommendations...'); 
        alternativeMatches = findAlternativeRecommendations(moviesTable, userGenre, userDirector);
<<<<<<< Updated upstream
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
        if isempty(alternativeMatches)
            disp('No alternative movies found.'); 
        else
            disp('Alternative movie recommendations:'); 
            disp(alternativeMatches.movie_name); 
        end
    else
        disp('Matching movies:');
        disp(unique(matches.movie_name, 'stable')); 
    end
   
    searchAgain = input('Do you want to search again? (y/n): ', 's');
    if strcmpi(searchAgain, 'n')
        disp('Returning to main menu...');
        return;
    end
end
end

function matches = findMatchingMovies(moviesTable, genre, director)
movieGenres = string(moviesTable.genre); 
movieDirectors = string(moviesTable.director);

genreMatches = true(height(moviesTable), 1); 
directorMatches = true(height(moviesTable), 1);

if genre ~= ""
    genreMatches = contains(movieGenres, genre, 'IgnoreCase', true); 
end 

if director ~= ""
    directorMatches = contains(movieDirectors, director, 'IgnoreCase', true);
end 

matches = moviesTable(genreMatches & directorMatches, :); 

if genre == "" && director == "" 
    matches = moviesTable([],:); 
end 
end 


function recommendations = findAlternativeRecommendations(moviesTable, genre, director) 

movieGenres = string(moviesTable.genre); 
movieDirectors = string(moviesTable.director); 

genreRecommendations = moviesTable([],:); 
directorRecommendations = moviesTable([],:); 

if genre ~= ""
    genreRecommendations = moviesTable(contains(movieGenres, genre, 'IgnoreCase', true), :); 
end 
if director ~= "" 
    directorRecommendations = moviesTable(contains(movieDirectors, director, 'IgnoreCase', true), :); 

end 
recommendations = [genreRecommendations; directorRecommendations]; 
[~, uniqueIdx] = unique(recommendations.movie_name, 'stable');
recommendations = recommendations(uniqueIdx,:);
end 

<<<<<<< Updated upstream
<<<<<<< Updated upstream
function cleanStr = normalizeInput(str) %Normalize the user's input
    str = lower(strtrim(str)); %Remove lowercase and spaces
    str = regexprep(str, '\s+', ''); %Remove extra spaces
    cleanStr = string(str); %Convert to strings
end

function bestMatch = fuzzyMatch(inputStr, itemList) %Find the closest match using fuzzy search algorithm
    if inputStr == "" || isempty(itemList) %If the input is empty
        bestMatch = ""; %Return empty string
        return;
    end

    itemList = string(itemList); %Convert list to string
    itemList = itemList(~ismissing(itemList)); %Remove missing values

    inputStr = normalizeInput(inputStr); %Normalize input string
    minDistance = inf; %Initialize the minimum distance
    bestMatch = ""; %Initialize best match

    for i = 1:length(itemList) %Loop through all existing items
        dist = levenshteinDistance(char(inputStr), char(itemList(i))); %Compute the Levenshtein distance-the min number of character edits required to change one word to another
        if dist < minDistance %If there is a closer match
            minDistance = dist; %Update minimum distance
            bestMatch = string(itemList(i)); %Update best match
        end
    end

    if minDistance > 5  %If match is different, do not consider it
        bestMatch = ""; %Return empty string
    end
end

function d = levenshteinDistance(s1, s2) %Function to compute Levenshtein distance
    s1 = char(s1); %Convert string to characters
    s2 = char(s2); 
    
    m = length(s1); %Get the length of the first string
    n = length(s2); %Get the length of the second string
    D = zeros(m+1, n+1); %Initialize the distance

    for i = 1:m+1 %Initialize 
=======
=======
>>>>>>> Stashed changes
function cleanStr = normalizeInput(str)
    str = lower(strtrim(str)); 
    str = regexprep(str, '\s+', '');
    cleanStr = string(str);
end

function bestMatch = fuzzyMatch(inputStr, itemList)
    if inputStr == "" || isempty(itemList)
        bestMatch = "";
        return;
    end

    itemList = string(itemList);
    itemList = itemList(~ismissing(itemList)); 

    inputStr = normalizeInput(inputStr);
    minDistance = inf;
    bestMatch = "";

    for i = 1:length(itemList)
        dist = levenshteinDistance(char(inputStr), char(itemList(i)));
        if dist < minDistance
            minDistance = dist;
            bestMatch = string(itemList(i));
        end
    end

    if minDistance > 5  
        bestMatch = "";
    end
end

function d = levenshteinDistance(s1, s2)
    s1 = char(s1);
    s2 = char(s2);
    
    m = length(s1);
    n = length(s2);
    D = zeros(m+1, n+1);

    for i = 1:m+1
<<<<<<< Updated upstream
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
        D(i, 1) = i-1;
    end
    for j = 1:n+1
        D(1, j) = j-1;
    end

    for i = 2:m+1
        for j = 2:n+1
            cost = ~(s1(i-1) == s2(j-1));
            D(i, j) = min([D(i-1, j) + 1, D(i, j-1) + 1, D(i-1, j-1) + cost]);
        end
    end

    d = D(m+1, n+1);
end